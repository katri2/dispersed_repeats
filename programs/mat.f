       program MAT_PEREMAT
       INTEGER MAT(4,4,1000),ST(1000),SEQ(1000)
       CHARACTER*5 PP,KLASS   
      OPEN(20,FILE='mat.txt',STATUS='replace')
      OPEN(25,FILE='uni.txt',STATUS='old')
       KLASS='klass'
Cklass=     1  ZZ=   8.8  J0=       36172  JM=       36813         657
CV2=120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149  0  0  0150151152153154155156157158159160161162163164165166167168169170171  0  0  0  0  0  0  0172173174175176177178179180181  0182183184185186187188189190191192193194195  0196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538  0  0  0539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584  0  0585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622  0  0  0623624625  0626627628629630631632633634  0  0  0  0  0  0  0635636637638639640641  0  0  0  0  0642643644645646647648649650651652653654655656657658  0  0  0  0  0  0  0  0  0  0659660661662663664665666  0  0  0  0667668669670671672673674675676677678679680681682683684685686687688689690691692693694695696697698699700701702703704705706707708709710711712713714715716717718719720721722723724725726727728729
CV1=  3  3  1  2  2  2  2  2  4  3  2  2  2  2  2  3  1  4  4  4  1  3  4  1  3  1  1  3  1  2  3  3  3  2  4  3  1  1  1  1  1  1  2  4  3  1  2  1  2  2  4  2  2  2  2  1  4  1  4  2  4  2  4  1  2  2  1  2  2  1  4  3  2  4  4  3  1  4  4  4  2  1  4  2  2  3  3  3  2  4  3  2  4  2  2  2  3  1  2  2  2  1  2  2  2  3  1  4  1  2  0  0  0  0  0  0  2  3  2  2  2  3  2  1  1  2  2  1  2  2  2  2  3  3  3  3  4  1  4  3  1  0  1  2  2  1  3  4  2  4  4  3  1  4  1  2  3  2  2  2  2  3  2  4  1  2  3  2  3  3  1  4  1  2  1  1  4  1  4  4  4  3  1  3  2  2  2  1  1  1  2  2  2  3  4  3  3  1  2  1  2  2  2  2  4  2  2  3  4  3  1  4  1  1  4  3  4  4  1  1  1  1  1  2  2  3  3  2  3  2  2  3  4  0  3  2  3  1  1  2  4  2  2  2  3  1  3  3  2  2  3  1  2  2  3  1  4  3  0  0  0  0  1  3  3  1  3  1  1  1  2  4  3  2  2  2  4  1  2  4  4  3  2  2  3  1  2  3  4  3  4  1  1  2  3  4  1  0  1  2  3  2  2  2  1  1  2  1  3  3  3  1  3  1  1  3  3  1  3  4  1  2  4  2  3  3  2  4  1  1  2  2  2  0  2  3  4  4  4  2  4  3  4  3  4  4  3  4  1  2  1  1  2  1  2  2  2  2  3  3  1  4  3  2  3  3  1  3  4  3  1  4  4  1  4  1  3  1  2  2  3  2  3  4  3  3  4  3  3  1  3  4  2  2  2  1  1  2  3  1  2  1  2  2  4  3  1  4  3  4  4  3  4  1  2  3  4  1  3  4  1  1  1  2  1  1  1  1  1  1  1  4  2  3  3  2  3  2  2  3  4  2  3  4  3  4  4  2  1  2  3  3  4  4  2  1  2  3  4  3  3  4  4  2  1  2  4  3  1  4  3  3  1  4  3  3  1  2  3  4  4  3  2  2  3  3  1  4  3  1  3  2  2  2  3  4  3  1  4  2  4  4  3  2  2  4  2  4  4  4  2  2  4  1  4  1  1  1  4  2  1  3  2  3  2  2  2  4  1  1  4  1  2  4  4  2  2  2  2  3  3  3  1  4  4  2  1  2  4  3  3  2  2  2  1  1  2  4  3  1  4  1  2  2  2  3  1  3  3  4  1  2  3  2  3  1  3  3  1  4  3  3  4  4  4  1  4  3  4  4  4  3  4  1  2  2  4  2  4  1  2  3  4  2  3  4  3  4  4  1  2  3  2  3  3  4  3  2  2  3  4  2  1  4  3  1  0  1  1  1  3  3  3  3  1  3  3  3  4  1  3  3  1  1  2  3  4  1  3  4  4  3  3  1  4  3  4
C          W(4)=D(I-1,J-1)+COR(SEQ2(KOR),SEQ2(I),SEQ1(J))
      MAT=0
      IPER=0 
11    READ(25,10,END=100) PP
10    FORMAT(A5)
      IF(PP.NE.KLASS) GO TO 11
C          BACKSPACE 25
        READ(25,1)(ST(I),I=1,1000)
        READ(25,1)(SEQ(I),I=1,1000)
1       FORMAT(3X,1000I3)
c
             DO 500 I=2,1000
                IF(SEQ(I-1).EQ.0) GO TO 500
                IF(SEQ(I).EQ.0) GO TO 500
                IF(ST(I).EQ.0) GO TO 500
                   IF(IPER.LT.ST(I)) IPER=ST(I)
                MAT(SEQ(I-1),SEQ(I),ST(I))=MAT(SEQ(I-1),SEQ(I),ST(I))+1
500         CONTINUE
      GO TO 11
c---------
100   CONTINUE
      if(iper.gt.800) PRINT 33
      if(iper.gt.800) STOP
33    FORMAT('MAKE THE REPEAT LENGTH LESS THAN 800')
C
           DO 273 I=1,4
           DO 272 J=1,4
              write(20,271) I,J,(MAT(I,J,K),K=1,IPER)
272        continue
273        continue
271        FORMAT('MCOR=',2x,'I=',I6,2X,'J=',I1,2X,1000I8)
cMCOR=  I=     1  J=1         0       0       0       0      67      35       7      18      19      21     107      82     140      69      10      16     137     104      81     282     107      87     254     104      93     296     160     109     247     141      80     245     114      97     312     164     115     343     191     141     358     161     120     322     176     124     417     217     130     422     256     236     262      86      61     259     152     104     375     260     157     212      62     235      93      20      21     192     226     196     434     204     181     386     215     141     314     200     237     427     155     187     442     197     200     425     204     183     499     222     204     301     165     180     442     201     172     172      71     250     182      46      67     310     146     141     359     208     238     414     201     173     376     146     181     452     194     189     327     180     201     219      70     258     163      32      79     329     166     168     413     219     226     447     142     176     376     165     196     408     198     173     337     178     228     459     185     190     400     184     237     301     114     153     487     177     155     365     182     240     484     173     208     412     168     216     379     152      57     149     184     270     459     243     165     297     102      83      55      44      43     329     274     245     460     224     156     214      73     112     247     152     216     499     164     178     413     192     170     320     131     416     179      33      25      84      72     181     463     192     260     306     110     285     450     132     227     292     136     291     350     131     242     345     141     316     387     132     269     356     113     267     331     157     244     335      57     362     118       8      39     279     149     220     320     134     276     407     137     278     359     162     292     341     142     230     260     149     261     413     165     248     348     130     550     243      48      86     307     145     205     336     128     594     175      28      60     337     152     206     209     103     282     313     163     393     307     135     293     252     117     358     251     102     397     335     139     286     218     106     368     269     105     391     320     143     415     298     120     292     228     105     413     293     145     395     269     110     361     229     122     276     184      98     377     401     152     331     294     130     405     232     116     380     263     137     381     214      93     419     392     142     339     221     100     343     232     117     443     307     131     430     264     156     278     137      83     344     328     145     413     294     125     374     260     110     338     267     141     455     289     113     353     312     110     318     224     108     388     285     160     422     271     136     385     263     120     387     282     150     367     253     106     351     264     125     443     329     124     332     227     134     390     271     119     356     239     113     364     317     136     376     232      93     321     224     129     492     296     123     446     277     110     327     186      79     270     302     147     415     234     130     381     291     128     366     260     118     413     299     110     343     172      78     359     246     115     338     235     116     379     294     135     460     360     123     351     212     124     423     236     103     379     290     123     420     214     107     359     257     120     301     214     101     463     357     123     362     224     123     353     239     131     384     239     120     456     312     128     331     185      87     350     262     125     543     286     128     307     214     125     445     291     132     397     298     124     352     256     129     442     340     115     335     261     125     413     277     130     443     297     140     340     241     132     402     231     104     387     264     145     392     266     142     355     216     129     423     290     144     409     311     133     419     275     138     372     242     126     385     254     107     407     297     128     386     225     123     360     287     180     404     331     158     386     306     113     312     306     120     243      73      23     260     106      26     212     246     174     350     284     138     321     352     147     401     389     182     300     274     135     264     241     116     236      71       8     132       0       0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
           WRITE(20,125) IPER
125        FORMAT('IPER=',I8)
           close (20)
           close (25)
       OPEN(22,FILE='nom.txt',STATUS='old')
cNOM=    21  IPER=   600
       READ(22,155)NOM,IPE
155    FORMAT(4X,I6,7X,I6)
       BACKSPACE 22
       WRITE(22,156) NOM,IPER
156    FORMAT('NOM=',I6,2X,'IPER=',I6)
       CLOSE (22)
      END          
