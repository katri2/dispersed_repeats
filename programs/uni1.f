      program uni
c-----------------------------------
      OPEN(22,FILE='uni1.txt',STATUS='replace')
      numprocs=4
c      NOM=0
      CALL DIR(numprocs,NOM)
      CALL INV(numprocs,NOM)
C------------------------------
c
        END
C==========================================================================
      subroutine DIR(numprocs,NOM)
      character*3 WWW1,WW1
      CHARACTER*4 WWW2,WW2
      character*2  ZET, PP2
      CHARACTER*1 TOT,NIT
      character*7 WWW3,WW3
c
      COMMON/LETO/LET
      CHARACTER*1 LET(0:10)
      INTEGER STOLB(10000), SEQ(10000)
      CHARACTER*3 PROM(10000),PU,STOLB1(10000)
      CALL ALF
       PU='   '
       TOT='.'
       ZET='Z='
       NOM=0
           DO 900 J7=1,numprocs
           write(WWW1,930) J7+500
           write(WW1,930)  id+200
           WW2=TOT//WW1     
           WW3=WWW1//WW2
930        format(I3)
c--------------------------------------------
       PRINT *, WW3
       OPEN(18,FILE=WW3,STATUS='old')
cZ=      4.2188215256  J=    164701  S22= 1017.45  I0=  1  J0=    164701  IM=381  JM=    165081  K10=     387     J0=    31 JM=   399  ZZ(J)=    8.92         1
c     V1= 31 32 33  0  0 34 35 36 37  0  0  0  0 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60  0 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83  0 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394  0  0  0  0  0  0  0  0  0  0395396397398399
c     V2=  2  2  3  1  1  4  3  3  4  3  2  3  3  2  2  4  3  3  4  1  2  4  2  3  1  1  1  3  4  4  3  2  2  4  2  3  4  1  4  3  1  3  1  4  1  3  2  2  4  3  0  0  4  3  1  2  4  3  4  3  2  3  4  4  3  3  1  2  4  4  4  1  1  2  3  1  4  4  3  2  4  2  3  2  4  4  3  4  3  4  3  1  4  3  3  4  4  4  3  1  4  4  4  3  1  1  2  4  1  4  0  1  1  1  2  2  3  1  2  3  3  2  3  2  3  3  1  2  1  3  3  4  4  3  3  4  4  3  3  1  2  4  2  3  1  2  1  4  3  2  4  3  4  3  1  4  1  2  4  4  3  4  2  2  2  3  1  4  4  3  4  2  3  3  4  4  3  4  1  4  3  2  3  3  2  4  3  1  4  3  1  4  4  3  4  4  2  3  4  3  3  2  1  1  4  2  3  1  2  1  4  3  3  1  2  1  4  2  2  3  1  4  4  2  2  4  1  2  4  3  3  3  4  1  4  1  1  4  4  1  4  2  3  4  1  2  1  2  3  3  1  4  3  1  4  3  1  4  1  2  1  1  4  1  3  1  4  3  4  4  4  4  2  3  2  2  3  1  2  3  3  4  3  2  4  3  4  3  3  3  4  4  2  3  2  4  2  3  2  3  3  2  4  1  1  1  4  1  4  3  2  4  3  2  2  3  1  4  3  1  2  4  4  3  2  2  3  4  3  4  4  2  2  3  1  4  3  1  4  1  3  3  4  4  2  3  1  2  3  0  0  0  4  3  4  2  3  4  2  4  4  4  1  4  4  3  4  2  4  4  1  1  4  3  4  3  1  3  4  4  3  2  2  3  4  3  2
10    read(18,55,end=100) PP2
      IF(PP2.NE.ZET) GO TO 10
55    FORMAT(A2)
        BACKSPACE 18
        READ(18,1) ZZ,I1,I2 
        PRINT 1, ZZ,I1,I2 
1       FORMAT(6X,F14.10,41X,I10,13X,I10) 
          IF(ZZ.LT.4.0) GO TO 10
            NOM=NOM+1
            IF(I2.GT.I1) NIT='+' 
            IF(I2.le.I1) NIT='-' 
            WRITE(22,2) ZZ,I1,I2,NIT,NOM
2           FORMAT('ZZ=',F8.2,2X, 'NA=',I10,2X,'KO=',I10,2X,'NIT=',A2,
     8      2X,'NOM=',I8)
            READ(18,144)(PROM(I),I=1,1000)
c            PRINT 144,(PROM(I),I=1,1000)
144         FORMAT(8X,1000A3)
              KOK=0
              DO 20 J=1,1000
                 J1=1001-J
                 IF(PROM(J1).NE.PU) KOK=J1
                 IF(PROM(J1).NE.PU)GO TO 21
20            CONTINUE
21            CONTINUE
C
              BACKSPACE 18
              print 777, KOK
777           FORMAT('KOK=',I8)
              READ(18,3)(STOLB(I),I=1,KOK)
              READ(18,3)(SEQ(I),I=1,KOK)
C
              CALL STOLB_CHANGE(STOLB,KOK,STOLB1)
C
              WRITE(22,4)(STOLB1(I),I=1,KOK)
              WRITE(22,4)(LET(SEQ(I)),I=1,KOK)

3             FORMAT(8X,10000I3)  
4             FORMAT(8X,10000A3)  
              GO TO 10
100    CONTINUE
       close (18)
900    CONTINUE
910    CONTINUE
       RETURN
       END
C==========================================================================
      subroutine INV(numprocs,NOM)
      character*3 WWW1,WW1
      CHARACTER*4 WWW2,WW2
      character*2  ZET, PP2
      CHARACTER*1 TOT,NIT
      character*7 WWW3,WW3
c
      COMMON/LETO/LET
      CHARACTER*1 LET(0:10)
      INTEGER STOLB(10000), SEQ(10000)
      CHARACTER*3 PROM(10000),PU,STOLB1(10000)
      CALL ALF
       PU='   '
       TOT='.'
       ZET='Z='
C       NOM=0
           DO 900 J7=1,numprocs
           write(WWW1,930) J7+900
           write(WW1,930)  id+200
           WW2=TOT//WW1     
           WW3=WWW1//WW2
930        format(I3)
c--------------------------------------------
       PRINT *, WW3
       OPEN(18,FILE=WW3,STATUS='old')
cZ=      4.2188215256  J=    164701  S22= 1017.45  I0=  1  J0=    164701  IM=381  JM=    165081  K10=     387     J0=    31 JM=   399  ZZ(J)=    8.92         1
c     V1= 31 32 33  0  0 34 35 36 37  0  0  0  0 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60  0 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83  0 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394  0  0  0  0  0  0  0  0  0  0395396397398399
c     V2=  2  2  3  1  1  4  3  3  4  3  2  3  3  2  2  4  3  3  4  1  2  4  2  3  1  1  1  3  4  4  3  2  2  4  2  3  4  1  4  3  1  3  1  4  1  3  2  2  4  3  0  0  4  3  1  2  4  3  4  3  2  3  4  4  3  3  1  2  4  4  4  1  1  2  3  1  4  4  3  2  4  2  3  2  4  4  3  4  3  4  3  1  4  3  3  4  4  4  3  1  4  4  4  3  1  1  2  4  1  4  0  1  1  1  2  2  3  1  2  3  3  2  3  2  3  3  1  2  1  3  3  4  4  3  3  4  4  3  3  1  2  4  2  3  1  2  1  4  3  2  4  3  4  3  1  4  1  2  4  4  3  4  2  2  2  3  1  4  4  3  4  2  3  3  4  4  3  4  1  4  3  2  3  3  2  4  3  1  4  3  1  4  4  3  4  4  2  3  4  3  3  2  1  1  4  2  3  1  2  1  4  3  3  1  2  1  4  2  2  3  1  4  4  2  2  4  1  2  4  3  3  3  4  1  4  1  1  4  4  1  4  2  3  4  1  2  1  2  3  3  1  4  3  1  4  3  1  4  1  2  1  1  4  1  3  1  4  3  4  4  4  4  2  3  2  2  3  1  2  3  3  4  3  2  4  3  4  3  3  3  4  4  2  3  2  4  2  3  2  3  3  2  4  1  1  1  4  1  4  3  2  4  3  2  2  3  1  4  3  1  2  4  4  3  2  2  3  4  3  4  4  2  2  3  1  4  3  1  4  1  3  3  4  4  2  3  1  2  3  0  0  0  4  3  4  2  3  4  2  4  4  4  1  4  4  3  4  2  4  4  1  1  4  3  4  3  1  3  4  4  3  2  2  3  4  3  2
10    read(18,55,end=100) PP2
      IF(PP2.NE.ZET) GO TO 10
55    FORMAT(A2)
        BACKSPACE 18
        READ(18,1) ZZ,I1,I2 
        PRINT 1, ZZ,I1,I2 
1       FORMAT(6X,F14.10,41X,I10,13X,I10) 
          IF(ZZ.LT.4.0) GO TO 10
            NOM=NOM+1
            IF(I2.GT.I1) NIT='+' 
            IF(I2.le.I1) NIT='-' 
            WRITE(22,2) ZZ,I1,I2,NIT,NOM
2           FORMAT('ZZ=',F8.2,2X, 'NA=',I10,2X,'KO=',I10,2X,'NIT=',A2,
     8      2X,'NOM=',I8)
            READ(18,144)(PROM(I),I=1,1000)
c            PRINT 144,(PROM(I),I=1,1000)
144         FORMAT(8X,1000A3)
              KOK=0
              DO 20 J=1,1000
                 J1=1001-J
                 IF(PROM(J1).NE.PU) KOK=J1
                 IF(PROM(J1).NE.PU)GO TO 21
20            CONTINUE
21            CONTINUE
C
              BACKSPACE 18
              print 777, KOK
777           FORMAT('KOK=',I8)  
              READ(18,3)(STOLB(I),I=1,KOK)
              READ(18,3)(SEQ(I),I=1,KOK)
C
              CALL STOLB_CHANGE(STOLB,KOK,STOLB1)
C
              WRITE(22,4)(STOLB1(I),I=1,KOK)
              WRITE(22,4)(LET(SEQ(I)),I=1,KOK)

3             FORMAT(8X,10000I3)  
4             FORMAT(8X,10000A3)  
              GO TO 10
100    CONTINUE
       close (18)
900    CONTINUE
910    CONTINUE
       RETURN
       END
C==========================================================================
      SUBROUTINE ALF
      COMMON/LETO/LET
      CHARACTER*1 LET(0:10)
      LET(0)='*'
      LET(1)='A'
      LET(2)='T'
      LET(3)='C'
      LET(4)='G'
      LET(5)='G'
      RETURN
      END
C=============================================================================
      SUBROUTINE STOLB_CHANGE(STOLB,KOK,STOLB1)
      INTEGER STOLB(10000),SEQ(10000)
      CHARACTER*3 STOLB1(10000),NUMB(0:10000)
      NUMB(0)='  *' 
      DO 10 I=1,999
         WRITE(NUMB(I),430) I  
c           write(WWW1,430) md+601
c           write(WW1,430)  id+100
430        format(I3)
10    continue
      DO 20 J=1,KOK
         STOLB1(J)=NUMB(STOLB(J))
20    CONTINUE
      RETURN
      END 

